# Results

```{r libraries}
# , warning = FALSE, message = FALSE, echo = TRUE, include = FALSE
# knitr::opts_chunk$set(warning = FALSE, 
#                       message = FALSE,
#                       echo = TRUE,
#                       include = FALSE)
# Libraries
library(tidyverse)
library(patchwork)
library(repr)
library(ggnewscale)
library(RColorBrewer)
library(Lock5withR)
library(dplyr)
```
**Question 1_1:**

**We want to know what you look for in the opposite sex.**

**Question 2_1:**

**What do you think the opposite sex looks for in a date?**

**Question 4_1:**

**Now we want to know what you think MOST of your fellow men/women look for in the opposite sex**

# Next Day

**Question 1_2:**

**We want to know what you look for in the opposite sex.**

**Question 2_2:**

**What do you think the opposite sex looks for in a date?**

**Question 4_2:**

**Now we want to know what you think MOST of your fellow men/women look for in the opposite sex**



### SRIVIDYA PART

```{r read_data}
df = read.csv("Speed Dating Data.csv")
col_common = c("iid", "pid", "gender", "match", "age", "field", "race", "from", "income", "goal", "career", "wave")
# df_1 = df[c(col_common, "attr1_1", "sinc1_1", "intel1_1", "fun1_1", "amb1_1")]
# df_2 = df[c(col_common, "attr2_1", "sinc2_1", "intel2_1", "fun2_1", "amb2_1")]
# df_4 = df[c(col_common, "attr4_1", "sinc4_1", "intel4_1", "fun4_1", "amb4_1")]
```

# Subsetting Dataset 

```{r}

df_work <- df[c(col_common, "attr1_1", "sinc1_1", "intel1_1", "fun1_1", "amb1_1",
                            "attr2_1", "sinc2_1", "intel2_1", "fun2_1", "amb2_1",
                            "attr4_1", "sinc4_1", "intel4_1", "fun4_1", "amb4_1",
                            "attr1_2", "sinc1_2", "intel1_2", "fun1_2", "amb1_2",
                            "attr2_2", "sinc2_2", "intel2_2", "fun2_2", "amb2_2",
                            "attr4_2", "sinc4_2", "intel4_2", "fun4_2", "amb4_2",
                            "satis_2")]

df_work <- df_work[ which(df_work$wave >= 10),]

```

```{r}

df_pre <- df_work[c(col_common, "attr1_1", "sinc1_1", "intel1_1", "fun1_1", "amb1_1",
                            "attr2_1", "sinc2_1", "intel2_1", "fun2_1", "amb2_1",
                            "attr4_1", "sinc4_1", "intel4_1", "fun4_1", "amb4_1")]

df_pre <- df_pre[ which(df_pre$wave >= 10),]

```


```{r}

df_post <- df_work[c(col_common, "attr1_2", "sinc1_2", "intel1_2", "fun1_2", "amb1_2",
                            "attr2_2", "sinc2_2", "intel2_2", "fun2_2", "amb2_2",
                            "attr4_2", "sinc4_2", "intel4_2", "fun4_2", "amb4_2",
                            "satis_2")]

df_post <- df_post[ which(df_post$wave >= 10),]

```

```{r}

df_contour_yes_pre <- df_pre[c("iid","match","attr1_1", "sinc1_1", "intel1_1", "fun1_1", "amb1_1")]

df_contour_yes_pre<- df_contour_yes_pre[ which(df_contour_yes_pre$match == 1),]

df_contour_yes_pre<- df_contour_yes_pre %>%
                      	group_by(iid,match) %>%
                      	summarise(mean_attr1_1 = mean(attr1_1),
                      	          mean_sinc1_1 = mean(sinc1_1),
                      	          mean_intel1_1 = mean(intel1_1),
                      	          mean_fun1_1 = mean(fun1_1),
                      	          mean_amb1_1 = mean(amb1_1))

# d1 <- pivot_longer(!iid, names_to = "colmn_names", values_to = "colmn_val")

df_contour_yes_pre <- pivot_longer(data = df_contour_yes_pre, cols = c("mean_attr1_1", "mean_sinc1_1", "mean_intel1_1", "mean_fun1_1", "mean_amb1_1"))

df_contour_yes_pre$value[is.na(df_contour_yes_pre$value)]<-mean(df_contour_yes_pre$value,na.rm=TRUE)

```

```{r}

df_contour_yes_post <- df_post[c("iid","match","attr1_2", "sinc1_2", "intel1_2", "fun1_2", "amb1_2")]

df_contour_yes_post <- df_contour_yes_post[ which(df_contour_yes_post$match == 1),]

df_contour_yes_post <- df_contour_yes_post %>%
                      	group_by(iid,match) %>%
                      	summarise(mean_attr1_2 = mean(attr1_2),
                      	          mean_sinc1_2 = mean(sinc1_2),
                      	          mean_intel1_2 = mean(intel1_2),
                      	          mean_fun1_2 = mean(fun1_2),
                      	          mean_amb1_2 = mean(amb1_2))

# d1 <- pivot_longer(!iid, names_to = "colmn_names", values_to = "colmn_val")

df_contour_yes_post <- pivot_longer(data = df_contour_yes_post, cols = c("mean_attr1_2", "mean_sinc1_2", "mean_intel1_2", "mean_fun1_2", "mean_amb1_2"))

df_contour_yes_post$value[is.na(df_contour_yes_post$value)]<-mean(df_contour_yes_post$value,na.rm=TRUE)

```

```{r}

# Contour plots for match 1 = yes post

df_contour_yes_post %>% ggplot(mapping = aes(x=name, y=value)) +
  geom_point(size=2,colour = "blue") +
  #geom_jitter() +
  theme_gray(10) + 
  ylab("Rating out of 100") + 
  xlab("Atrribute") + 
  ggtitle("Post - Atrribute vs Rating for match = yes")


# Contour plots for match 1 = yes pre

df_contour_yes_pre %>% ggplot(mapping = aes(x=name, y=value)) +
  geom_point(size=2,colour = "blue") +
  #geom_jitter() +
  theme_gray(10) + 
  ylab("Rating out of 100") + 
  xlab("Atrribute") + 
  ggtitle("Pre - Atrribute vs Rating for match = yes")

```
```{r}

df_contour_no_pre <- df_pre[c("iid","match","attr1_1", "sinc1_1", "intel1_1", "fun1_1", "amb1_1")]

df_contour_no_pre<- df_contour_no_pre[ which(df_contour_no_pre$match == 0),]

df_contour_no_pre<- df_contour_no_pre %>%
                      	group_by(iid,match) %>%
                      	summarise(mean_attr1_1 = mean(attr1_1),
                      	          mean_sinc1_1 = mean(sinc1_1),
                      	          mean_intel1_1 = mean(intel1_1),
                      	          mean_fun1_1 = mean(fun1_1),
                      	          mean_amb1_1 = mean(amb1_1))

# d1 <- pivot_longer(!iid, names_to = "colmn_names", values_to = "colmn_val")

df_contour_no_pre <- pivot_longer(data = df_contour_no_pre, cols = c("mean_attr1_1", "mean_sinc1_1", "mean_intel1_1", "mean_fun1_1", "mean_amb1_1"))

df_contour_no_pre$value[is.na(df_contour_no_pre$value)]<-mean(df_contour_no_pre$value,na.rm=TRUE)

```

```{r}

df_contour_no_post <- df_post[c("iid","match","attr1_2", "sinc1_2", "intel1_2", "fun1_2", "amb1_2")]

df_contour_no_post <- df_contour_no_post[ which(df_contour_no_post$match == 1),]

df_contour_no_post <- df_contour_no_post %>%
                      	group_by(iid,match) %>%
                      	summarise(mean_attr1_2 = mean(attr1_2),
                      	          mean_sinc1_2 = mean(sinc1_2),
                      	          mean_intel1_2 = mean(intel1_2),
                      	          mean_fun1_2 = mean(fun1_2),
                      	          mean_amb1_2 = mean(amb1_2))

# d1 <- pivot_longer(!iid, names_to = "colmn_names", values_to = "colmn_val")

df_contour_no_post <- pivot_longer(data = df_contour_no_post, cols = c("mean_attr1_2", "mean_sinc1_2", "mean_intel1_2", "mean_fun1_2", "mean_amb1_2"))

df_contour_no_post$value[is.na(df_contour_no_post$value)]<-mean(df_contour_no_post$value,na.rm=TRUE)

```

```{r}

# Contour plots for match 0 = no post

df_contour_no_post %>% ggplot(mapping = aes(x=name, y=value)) +
  geom_point(size=2,colour = "red") +
  #geom_jitter() +
  theme_gray(10) + 
  ylab("Rating out of 100") + 
  xlab("Atrribute") + 
  ggtitle("Post - Atrribute vs Rating for match = no")


# Contour plots for match 0 = no pre

df_contour_no_pre %>% ggplot(mapping = aes(x=name, y=value)) +
  geom_point(size=2,colour = "red") +
  #geom_jitter() +
  theme_gray(10) + 
  ylab("Rating out of 100") + 
  xlab("Atrribute") + 
  ggtitle("Pre - Atrribute vs Rating for match = no")

```

```{r}

df_bar_pre <- df_pre[c("gender","attr1_1", "sinc1_1", "intel1_1", "fun1_1", "amb1_1",
                                          "attr2_1", "sinc2_1", "intel2_1", "fun2_1", "amb2_1",
                                          "attr4_1", "sinc4_1", "intel4_1", "fun4_1", "amb4_1")]

for(i in 1:ncol(df_bar_pre)){
  df_bar_pre[is.na(df_bar_pre[,i]), i] <- mean(df_bar_pre[,i], na.rm = TRUE)
}


df_bar_pre <- df_bar_pre %>% 
                    group_by(gender) %>%
                      summarise(across(everything(), mean))


```



```{r}

# df_bar_pre <- df_pre[c("gender","attr1_1", "sinc1_1", "intel1_1", "fun1_1", "amb1_1",
#                                           "attr2_1", "sinc2_1", "intel2_1", "fun2_1", "amb2_1",
#                                           "attr4_1", "sinc4_1", "intel4_1", "fun4_1", "amb4_1")]
# 
# for(i in 1:ncol(df_bar_pre)){
#   df_bar_pre[is.na(df_bar_pre[,i]), i] <- mean(df_bar_pre[,i], na.rm = TRUE)
# }
# 
# 
# df_bar_pre <- df_bar_pre %>% 
#                     group_by(gender) %>%
#                       summarise(across(everything(), median))


```

```{r}

df_bar_pre_f <- df_bar_pre[ which(df_bar_pre$gender == 0),]

df_bar_pre_f <- pivot_longer(data = subset (df_bar_pre_f , select = -gender), 
                             cols = c("attr1_1", "sinc1_1", "intel1_1", "fun1_1", "amb1_1",
                                          "attr2_1", "sinc2_1", "intel2_1", "fun2_1", "amb2_1",
                                          "attr4_1", "sinc4_1", "intel4_1", "fun4_1", "amb4_1"))

df_bar_pre_f$Attribute <- substr(df_bar_pre_f$name, 0, 3)


df_bar_pre_plt_f <- df_bar_pre_f%>% 
  gather(Attr, plot_v, -c(Attribute, value)) %>%
    mutate(Attribute = factor(Attribute, 
                        levels = c("att", "sin", "int", "fun", "amb"))) %>%
      arrange(Attribute)

```

```{r}

df_bar_pre_m <- df_bar_pre[ which(df_bar_pre$gender == 1),]

df_bar_pre_m <- pivot_longer(data = subset (df_bar_pre_m , select = -gender), 
                             cols = c("attr1_1", "sinc1_1", "intel1_1", "fun1_1", "amb1_1",
                                          "attr2_1", "sinc2_1", "intel2_1", "fun2_1", "amb2_1",
                                          "attr4_1", "sinc4_1", "intel4_1", "fun4_1", "amb4_1"))

df_bar_pre_m$Attribute <- substr(df_bar_pre_m$name, 0, 3)


df_bar_pre_plt_m <- df_bar_pre_m%>% 
  gather(Attr, plot_v, -c(Attribute, value)) %>%
    mutate(Attribute = factor(Attribute, 
                        levels = c("att", "sin", "int", "fun", "amb"))) %>%
      arrange(Attribute)

```


```{r}

colourCount = 15
getPalette = colorRampPalette(brewer.pal(9, "RdYlGn"))

ggplot(data = df_bar_pre_plt_f) +
  geom_bar(aes(x = Attribute,
               y = value,
               fill = plot_v,
               color = plot_v),
           stat = "identity",
           position = position_dodge()) +
  scale_fill_manual(values = getPalette(colourCount)) +
  theme(legend.title=element_blank()) + 
  ylab("Rating out of 100") + 
  xlab("Atrributes") + 
  ggtitle("Pre - Female - Attribute rating comparison")


ggplot(data = df_bar_pre_plt_m) +
  geom_bar(aes(x = Attribute,
               y = value,
               fill = plot_v,
               color = plot_v),
           stat = "identity",
           position = position_dodge()) +
  scale_fill_manual(values = getPalette(colourCount)) +
  theme(legend.title=element_blank()) + 
  ylab("Rating out of 100") + 
  xlab("Atrributes") + 
  ggtitle("Pre - Male - Attribute rating comparison")

```


```{r}

df_bar_post <- df_post[c("gender","attr1_2", "sinc1_2", "intel1_2", "fun1_2", "amb1_2",
                                          "attr2_2", "sinc2_2", "intel2_2", "fun2_2", "amb2_2",
                                          "attr4_2", "sinc4_2", "intel4_2", "fun4_2", "amb4_2")]

for(i in 1:ncol(df_bar_post)){
  df_bar_post[is.na(df_bar_post[,i]), i] <- mean(df_bar_post[,i], na.rm = TRUE)
}


df_bar_post <- df_bar_post %>% 
                    group_by(gender) %>%
                      summarise(across(everything(), mean))


```


```{r}

# df_bar_post <- df_post[c("gender","attr1_2", "sinc1_2", "intel1_2", "fun1_2", "amb1_2",
#                                           "attr2_2", "sinc2_2", "intel2_2", "fun2_2", "amb2_2",
#                                           "attr4_2", "sinc4_2", "intel4_2", "fun4_2", "amb4_2")]
# 
# for(i in 1:ncol(df_bar_post)){
#   df_bar_post[is.na(df_bar_post[,i]), i] <- mean(df_bar_post[,i], na.rm = TRUE)
# }
# 
# 
# df_bar_post <- df_bar_post %>% 
#                     group_by(gender) %>%
#                       summarise(across(everything(), median))


```

```{r}

df_bar_post_f <- df_bar_post[ which(df_bar_post$gender == 0),]

df_bar_post_f <- pivot_longer(data = subset (df_bar_post_f , select = -gender), 
                             cols = c("attr1_2", "sinc1_2", "intel1_2", "fun1_2", "amb1_2",
                                          "attr2_2", "sinc2_2", "intel2_2", "fun2_2", "amb2_2",
                                          "attr4_2", "sinc4_2", "intel4_2", "fun4_2", "amb4_2"))

df_bar_post_f$Attribute <- substr(df_bar_post_f$name, 0, 3)


df_bar_post_plt_f <- df_bar_post_f%>% 
  gather(Attr, plot_v, -c(Attribute, value)) %>%
    mutate(Attribute = factor(Attribute, 
                        levels = c("att", "sin", "int", "fun", "amb"))) %>%
      arrange(Attribute)

```

```{r}

df_bar_post_m <- df_bar_post[ which(df_bar_post$gender == 1),]

df_bar_post_m <- pivot_longer(data = subset (df_bar_post_m , select = -gender), 
                             cols = c("attr1_2", "sinc1_2", "intel1_2", "fun1_2", "amb1_2",
                                          "attr2_2", "sinc2_2", "intel2_2", "fun2_2", "amb2_2",
                                          "attr4_2", "sinc4_2", "intel4_2", "fun4_2", "amb4_2"))

df_bar_post_m$Attribute <- substr(df_bar_post_m$name, 0, 3)


df_bar_post_plt_m <- df_bar_post_m%>% 
  gather(Attr, plot_v, -c(Attribute, value)) %>%
    mutate(Attribute = factor(Attribute, 
                        levels = c("att", "sin", "int", "fun", "amb"))) %>%
      arrange(Attribute)

```


```{r}

colourCount = 15
getPalette = colorRampPalette(brewer.pal(9, "RdYlGn"))

ggplot(data = df_bar_post_plt_f) +
  geom_bar(aes(x = Attribute,
               y = value,
               fill = plot_v,
               color = plot_v),
           stat = "identity",
           position = position_dodge()) +
  scale_fill_manual(values = getPalette(colourCount)) +
  theme(legend.title=element_blank()) + 
  ylab("Rating out of 100") + 
  xlab("Atrributes") + 
  ggtitle("Post - Female - Attribute rating comparison")


ggplot(data = df_bar_post_plt_m) +
  geom_bar(aes(x = Attribute,
               y = value,
               fill = plot_v,
               color = plot_v),
           stat = "identity",
           position = position_dodge()) +
  scale_fill_manual(values = getPalette(colourCount)) +
  theme(legend.title=element_blank()) + 
  ylab("Rating out of 100") + 
  xlab("Atrributes") + 
  ggtitle("Post - Male - Attribute rating comparison")

```

```{r}

df_satis <- df_post[c("iid","gender","match", "satis_2")]

df_satis_f <- df_satis[ which(df_satis$gender == 0),]

df_satis_f_1 <- df_satis_f %>%
              group_by(iid) %>%
                summarise(no_matches = sum(match),
                          satisfied = median(satis_2))

# ggplot(df_satis_f_1, aes(x = no_matches, y = satisfied, fill= count(group_by(c(no_matches,satisfied))))) + 
#   geom_tile()

df_satis_f_1 <- subset (df_satis_f_1 , select = -iid)

df_satis_f_1<-data.frame(table(df_satis_f_1))

df_satis_f_1 <- df_satis_f_1 %>%
              group_by(no_matches) %>%
                mutate(freqsum = sum(Freq))

df_satis_f_1$Freq<-as.factor(as.numeric(100*(df_satis_f_1$Freq/df_satis_f_1$freqsum)))
df_satis_f_1$no_matches<-as.character(df_satis_f_1$no_matches) %>% as.numeric()
df_satis_f_1$satisfied<-as.character(df_satis_f_1$satisfied) %>% as.numeric()

# plot using ggplot
ggplot(df_satis_f_1,aes(x=no_matches,y=satisfied)) +
geom_tile(aes(fill=Freq))


# mat_satis <- as.matrix(subset (df_satis_f_1 , select = -iid))
# heatmap(mat_satis)

```

```{r}

df_satis <- df_post[c("iid","gender","match", "satis_2")]

df_satis_f <- df_satis[ which(df_satis$gender == 1),]

df_satis_f_1 <- df_satis_f %>%
              group_by(iid) %>%
                summarise(no_matches = sum(match),
                          satisfied = median(satis_2))

# ggplot(df_satis_f_1, aes(x = no_matches, y = satisfied, fill= count(group_by(c(no_matches,satisfied))))) + 
#   geom_tile()

df_satis_f_1 <- subset (df_satis_f_1 , select = -iid)

df_satis_f_1<-data.frame(table(df_satis_f_1))

df_satis_f_1$Freq<-as.factor(df_satis_f_1$Freq)
df_satis_f_1$no_matches<-as.character(df_satis_f_1$no_matches) %>% as.numeric()
df_satis_f_1$satisfied<-as.character(df_satis_f_1$satisfied) %>% as.numeric()

# plot using ggplot
ggplot(df_satis_f_1,aes(x=no_matches,y=satisfied)) +
geom_tile(aes(fill=Freq)) +
geom_text(aes(label=Freq))


# mat_satis <- as.matrix(subset (df_satis_f_1 , select = -iid))
# heatmap(mat_satis)

```

